# SpeedType 项目计划文档

本文档旨在记录 SpeedType 项目的核心功能需求、技术选型和开发计划，以作为后续开发的指导蓝图。

## 1. 项目概述

SpeedType 是一款 macOS 平台的打字速度测试与练习应用。它旨在提供一个简洁、高效且富有社交乐趣的打字体验。用户不仅可以测试预设的文本内容，还可以自定义文本进行练习，并将自己的成绩以精美的卡片形式分享给朋友，朋友通过扫描卡片上的二维码即可参与相同的挑战。

## 2. 技术背景与选型

- **开发工具**: Xcode 16.4+
- **编程语言**: Swift 5.0+
- **UI 框架**: SwiftUI
- **目标平台**: macOS
- **核心技术决策**:
    - **计时方案**: 采用基于 `CACurrentMediaTime()` 的高精度时间戳差值计算，确保计时的精确性和可靠性。显示给用户的时间将格式化为三位小数（毫秒级）。
    - **分享方案**: 
        - **形式**: 分享内容为一张动态生成的“成绩卡片”图片，而非纯文本或链接。
        - **交互**: 卡片上将包含一个二维码。
        - **链接技术**: 二维码内嵌一个自定义 URL Scheme 链接 (例如 `speedtype://...`)。
        - **内容传递**: 
            - **预设挑战**: 链接将包含挑战的唯一标识符 (e.g., `speedtype://challenge/alphabet`)。
            - **自定义文本**: 采用方案A，将用户输入的自定义文本进行 URL 编码后直接附加到链接中。此方案无需后端，开发迅速，但需接受URL长度限制的局限性。

## 3. 核心功能 (MVP 版本)

1.  **挑战模式**: 应用的核心玩法。
    -   提供一个UI元素（如下拉菜单或列表）让用户选择不同的打字挑战。
    -   **预设挑战**: 内置多种固定的打字内容，例如：
        -   26个英文字母 (顺序)
        -   键盘布局字母
        -   中文百家姓 (部分)
    -   **自定义挑战**: 允许用户输入任意文本作为打字内容。

2.  **打字测试核心界面**:
    -   清晰地展示待输入的文本。
    -   提供一个文本输入框供用户打字。
    -   实时显示计时器。
    -   输入正确性判断。
    -   提供重置功能。

3.  **结果分享**:
    -   完成测试后，可以生成一张包含以下信息的成绩卡片图片：
        -   挑战名称 (如 “26字母表挑战”)
        -   所用时间
        -   App Logo 或名称
        -   一个包含挑战信息的二维码
    -   调用系统分享服务，将该图片分享出去。

## 4. 开发步骤规划

我们将采用敏捷、分步迭代的方式进行开发：

1.  **步骤一：模型与UI基础重构**
    -   定义 `Challenge` 数据结构，用于封装挑战的标题和文本内容。
    -   在 `ContentView` 中，实现一个UI组件（如 `Picker`）来让用户选择不同的 `Challenge`。

2.  **步骤二：实现核心打字逻辑**
    -   实现计时器的启动、停止和重置。
    -   实现用户输入与目标文本的实时比对和验证逻辑。
    -   完成测试后，计算并显示最终成绩。

3.  **步骤三：开发分享卡片功能**
    -   使用 SwiftUI 设计一个独立的 `ShareCardView` 视图，用于展示成绩卡片。
    -   编写一个辅助函数，将这个 SwiftUI 视图渲染成 `NSImage` 对象。
    -   集成一个二维码生成库，根据挑战内容生成二维码图片。

4.  **步骤四：整合分享流程**
    -   将生成的成绩卡片图片和分享文本传递给 `NSSharingServicePicker` 来调起系统分享菜单。

5.  **步骤五 (后续迭代): 链接处理**
    -   为应用配置自定义 URL Scheme。
    -   在 `SpeedTypeApp` 中添加入口逻辑，用于处理通过链接启动应用的情况，解析链接参数并自动设置对应的挑战。

6.  **步骤六 (未来展望): 探索后端方案**
    -   如果用户对分享长文本的需求强烈，届时再评估和开发方案B（云端存储方案）。
